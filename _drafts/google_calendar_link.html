<!DOCTYPE html>
<html>
<head>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment-timezone/0.5.28/moment-timezone-with-data.min.js"></script>
</head>

<body>

<h2>Create Google Calendar Event Link</h2>

<form id="calendarEvent">
  <label for="event_name">Event Name:</label><br>
  <input type="text" id="event_name" name="event_name" value=""><br>

  <label for="date_time_from">Start Date & Time:</label><br>
  <input type="datetime-local" id="date_time_from" name="date_time_from"><br>

  <label for="date_time_to">End Date & Time:</label><br>
  <input type="datetime-local" id="date_time_to" name="date_time_to"><br><br>

    <label for="timezone">Time Zone:</label><br>
  <select id="timezone">
  </select><br><br>

  <label for="url">Google Calendar URL:</label><br>
  <input type="text" id="url" name="url" value="" disabled><br>
  <button onclick="copyText()">Copy ðŸ”—</button><br><br>

  <input type="submit" value="Go to link">
</form>

<p>Click the "Go to link" after you have filled out the event details to navigate to the google calendar page, or click the copy button to copy the URL!</p>

<script>
// Populate timezone dropdown
var tzSelect = document.getElementById('timezone');
for (var i in Intl.DateTimeFormat().resolvedOptions().timeZone) {
    var opt = document.createElement('option');
    opt.value = i;
    opt.innerHTML = i;
    tzSelect.appendChild(opt);
}

// Pre-fill date and time fields
var currentDate = new Date(new Date().getTime() + 24 * 60 * 60 * 1000); // tomorrow
currentDate.setHours(8, 0, 0, 0);

// Build a timestamp that aligns with the user's local timezone
var tzOffset = currentDate.getTimezoneOffset() * 60; // offset in seconds
var localISOTime = (new Date(currentDate.getTime() - tzOffset)).toISOString().slice(0, -1);

var formattedStart = localISOTime.slice(0, 16);
var formattedEnd = new Date(new Date(formattedStart).getTime() + 2 * 60 * 60 * 1000).toISOString().slice(0, 16);

<!--// convert Date objects into strings-->
<!--var iso = currentDate.toISOString();-->
<!--var isoEnd = new Date(currentDate.getTime() + 2 * 60 * 60 * 1000).toISOString();-->

<!--// get date and time in the format "YYYY-MM-DDTHH:mm"-->
<!--var formattedStart = iso.slice(0,16);-->
<!--var formattedEnd = isoEnd.slice(0,16);-->

document.getElementById('date_time_from').value = formattedStart;
document.getElementById('date_time_to').value = formattedEnd;

// Populate timezone dropdown with IANA time zones and their standard text labels
var tzSelect = document.getElementById('timezone');
var timeZones = moment.tz.names();
for (var i = 0; i < timeZones.length; i++) {
    var opt = document.createElement('option');
    opt.value = timeZones[i];
    opt.innerHTML = timeZones[i];
    tzSelect.appendChild(opt);
}

// Set default timezone
tzSelect.value = moment.tz.guess();

document.getElementById("calendarEvent").addEventListener("submit", function(event){
  event.preventDefault();

  var calendar_url = createLink()

  window.open(calendar_url, '_blank');
});

function createLink(){
  var name = document.getElementById('event_name').value;
  var startTime = document.getElementById('date_time_from').valueAsNumber;
  var endTime = document.getElementById('date_time_to').valueAsNumber;

  var calendar_url = 'https://calendar.google.com/calendar/u/0/r/eventedit?';
  calendar_url += 'text='+encodeURIComponent(name);

  var timezone = document.getElementById('timezone').value;
  formattedStart = moment.tz(new Date(startTime), timezone).format('YYYYMMDD[T]HHmmss');
  formattedEnd = moment.tz(new Date(endTime), timezone).format('YYYYMMDD[T]HHmmss');
  calendar_url += '&dates=' + formattedStart + '/' + formattedEnd;
  calendar_url += '&ctz=' + timezone;

  document.getElementById('url').value = calendar_url;



  return calendar_url;
}

function copyText() {
  var copyText = document.getElementById("url");
  copyText.select();
  copyText.setSelectionRange(0, 99999)

  document.execCommand("copy");
}

document.getElementById('calendarEvent').addEventListener('input', function () {
    createLink();
});
</script>

</body>
</html>